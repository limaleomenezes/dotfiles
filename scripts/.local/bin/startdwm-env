#!/bin/sh

services='dunst
dwmblocks
picom
redshift
sxhkd'
programs='chromium
firefox'

init() {
	printf '%s\n' "$services" | while IFS= read -r service; do
		"$service" >/dev/null 2>&1 & disown
		printf '[START SERVICE] [%s]\n' "$service" >> ~/.dwm.log
	done
	printf '%s\n' "$programs" | while IFS= read -r program; do
		"$program" >/dev/null 2>&1 &
		printf '[START PROGRAM] [%s]\n' "$program" >> ~/.dwm.log
	done
}

end() {
	printf '%s\n' "$services" | while IFS= read -r service; do
		pkill -9 "$service" >/dev/null
		printf '[END SERVICE] [%s]\n' "$service" >> ~/.dwm.log
	done
	printf '%s\n' "$programs" | while IFS= read -r program; do
		pkill -SIGTERM "$program" >/dev/null
		printf '[END PROGRAM] [%s]\n' "$program" >> ~/.dwm.log
	done
	mv -f ~/.dwm.log ~/.dwm.log.old
}

case "$1" in
	'init')
		printf '\n[START DWM-ENV]\n' >> ~/.dwm.log
		init
		;;
	'end')
		printf '\n[END DWM-ENV] [%s]\n' "$(date)" >> ~/.dwm.log
		end
		;;
	'reload')
		printf '\n[RELOAD DWM-ENV] [%s]\n' "$(date)" >> ~/.dwm.log
		end
		init
		;;
esac

